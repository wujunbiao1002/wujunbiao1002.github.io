(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{783:function(e,t,s){Promise.resolve().then(s.bind(s,947))},947:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return H}});var a=s(7437),n=s(2265),l=s(5348),i=s(8509),r=s(4277),o=s(3868);let c="hasClosedAnnouncement_v5";function d(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{localStorage.getItem(c)||t(!0)},[]),(0,a.jsx)(l.M,{children:e&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",inset:0,zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(4px)",padding:"20px"},children:(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},className:"glass",style:{width:"100%",maxWidth:"400px",padding:"24px",position:"relative",display:"flex",flexDirection:"column",gap:"16px"},children:[(0,a.jsxs)("div",{className:"title",style:{display:"flex",alignItems:"center",gap:"12px",fontWeight:700,fontSize:"18px",color:"var(--accent)"},children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),(0,a.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,a.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),(0,a.jsx)("span",{children:"公告"})]}),(0,a.jsxs)("div",{style:{color:"var(--text)",lineHeight:"1.6",fontSize:"15px"},children:["感谢使用！",(0,a.jsx)("p",{children:"实时估值与重仓直连东方财富，仅供参考使用，不作为任何投资建议。"})]}),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:(0,a.jsx)("button",{className:"button",onClick:()=>{localStorage.setItem(c,"true"),t(!1)},style:{width:"100%",justifyContent:"center",display:"flex",alignItems:"center"},children:"我知道了"})})]})})})}var m={src:"/fund/_next/static/media/zhifubao.895e3910.jpg"},u={src:"/fund/_next/static/media/weixin.04c23e08.jpg"};function h(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function p(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M8 6l1-2h6l1 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M6 6l1 13a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2l1-13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function x(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M19.4 15a7.97 7.97 0 0 0 .1-2l2-1.5-2-3.5-2.3.5a8.02 8.02 0 0 0-1.7-1l-.4-2.3h-4l-.4 2.3a8.02 8.02 0 0 0-1.7 1l-2.3-.5-2 3.5 2 1.5a7.97 7.97 0 0 0 .1 2l-2 1.5 2 3.5 2.3-.5a8.02 8.02 0 0 0 1.7 1l.4 2.3h4l.4-2.3a8.02 8.02 0 0 0 1.7-1l2.3.5 2-3.5-2-1.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function g(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("path",{d:"M4 12a8 8 0 0 1 12.5-6.9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M16 5h3v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M20 12a8 8 0 0 1-12.5 6.9",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M8 19H5v-3",stroke:"currentColor",strokeWidth:"2"})]})}function y(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function j(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M3 7h18M6 12h12M9 17h6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function f(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"})]})}function v(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function b(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function N(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function w(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M4 8h16M4 12h16M4 16h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function S(e){let{filled:t,...s}=e;return(0,a.jsx)("svg",{...s,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:t?"var(--accent)":"none",children:(0,a.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",stroke:"var(--accent)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function k(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,a.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,a.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,a.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}function C(e){let{value:t,onChange:s}=e,[r,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(()=>t?new Date(t):new Date);(0,n.useEffect)(()=>{let e=()=>o(!1);return r&&window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[r]);let m=c.getFullYear(),u=c.getMonth(),h=(e,t)=>{e.stopPropagation();let a="".concat(m,"-").concat(String(u+1).padStart(2,"0"),"-").concat(String(t).padStart(2,"0")),n=new Date;n.setHours(0,0,0,0),new Date(a)>n||(s(a),o(!1))},p=new Date(m,u+1,0).getDate(),x=new Date(m,u,1).getDay(),g=[];for(let e=0;e<x;e++)g.push(null);for(let e=1;e<=p;e++)g.push(e);return(0,a.jsxs)("div",{className:"date-picker",style:{position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"input-trigger",onClick:()=>o(!r),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",height:"40px",background:"rgba(0,0,0,0.2)",borderRadius:"8px",cursor:"pointer",border:"1px solid transparent",transition:"all 0.2s"},children:[(0,a.jsx)("span",{children:t||"选择日期"}),(0,a.jsx)(k,{width:"16",height:"16",className:"muted"})]}),(0,a.jsx)(l.M,{children:r&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"glass card",style:{position:"absolute",top:"100%",left:0,width:"100%",marginTop:8,padding:12,zIndex:10,background:"rgba(30, 41, 59, 0.95)",backdropFilter:"blur(12px)",border:"1px solid rgba(255,255,255,0.1)"},children:[(0,a.jsxs)("div",{className:"calendar-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),d(new Date(m,u-1,1))},className:"icon-button",style:{width:24,height:24},children:"<"}),(0,a.jsxs)("span",{style:{fontWeight:600},children:[m,"年 ",u+1,"月"]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),d(new Date(m,u+1,1))},className:"icon-button",style:{width:24,height:24},children:">"})]}),(0,a.jsxs)("div",{className:"calendar-grid",style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,textAlign:"center"},children:[["日","一","二","三","四","五","六"].map(e=>(0,a.jsx)("div",{className:"muted",style:{fontSize:"12px",marginBottom:4},children:e},e)),g.map((e,s)=>{if(!e)return(0,a.jsx)("div",{},s);let n="".concat(m,"-").concat(String(u+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0")),l=t===n,i=new Date;i.setHours(0,0,0,0);let r=new Date(n),o=r.getTime()===i.getTime(),c=r>i;return(0,a.jsx)("div",{onClick:t=>!c&&h(t,e),style:{height:28,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"13px",borderRadius:"6px",cursor:c?"not-allowed":"pointer",background:l?"var(--primary)":o?"rgba(255,255,255,0.1)":"transparent",color:c?"var(--muted)":l?"#000":"var(--text)",fontWeight:l||o?600:400,opacity:c?.3:1},onMouseEnter:e=>{l||c||(e.currentTarget.style.background="rgba(255,255,255,0.1)")},onMouseLeave:e=>{l||c||(e.currentTarget.style.background=o?"rgba(255,255,255,0.1)":"transparent")},children:e},s)})]})]})})]})}function z(){let[e,t]=(0,n.useState)("alipay");return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[(0,a.jsxs)("div",{className:"tabs glass",style:{padding:4,borderRadius:12,width:"100%",display:"flex"},children:[(0,a.jsx)("button",{onClick:()=>t("alipay"),style:{flex:1,padding:"8px 0",border:"none",background:"alipay"===e?"rgba(34, 211, 238, 0.15)":"transparent",color:"alipay"===e?"var(--primary)":"var(--muted)",borderRadius:8,cursor:"pointer",fontSize:"14px",fontWeight:600,transition:"all 0.2s ease"},children:"支付宝"}),(0,a.jsx)("button",{onClick:()=>t("wechat"),style:{flex:1,padding:"8px 0",border:"none",background:"wechat"===e?"rgba(34, 211, 238, 0.15)":"transparent",color:"wechat"===e?"var(--primary)":"var(--muted)",borderRadius:8,cursor:"pointer",fontSize:"14px",fontWeight:600,transition:"all 0.2s ease"},children:"微信支付"})]}),(0,a.jsx)("div",{style:{width:200,height:200,background:"white",borderRadius:12,padding:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"alipay"===e?(0,a.jsx)("img",{src:m.src,alt:"支付宝收款码",style:{width:"100%",height:"100%",objectFit:"contain"}}):(0,a.jsx)("img",{src:u.src,alt:"微信收款码",style:{width:"100%",height:"100%",objectFit:"contain"}})})]})}function E(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function M(e){let{value:t,onChange:s,step:n=1,min:l=0,placeholder:i}=e,r=String(n).includes(".")?String(n).split(".")[1].length:0,o=e=>Number(e).toFixed(r);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsx)("input",{type:"number",step:"any",className:"input no-zoom",value:t,onChange:e=>s(e.target.value),placeholder:i,style:{width:"100%",paddingRight:56}}),(0,a.jsxs)("div",{style:{position:"absolute",right:6,top:6,display:"flex",flexDirection:"column",gap:6},children:[(0,a.jsx)("button",{className:"icon-button",type:"button",onClick:()=>{let e=parseFloat(t);s(o((isNaN(e)?0:e)+n))},style:{width:44,height:16,padding:0},children:(0,a.jsx)(h,{width:"14",height:"14"})}),(0,a.jsx)("button",{className:"icon-button",type:"button",onClick:()=>{let e=parseFloat(t);s(o(Math.max(l,(isNaN(e)?0:e)-n)))},style:{width:44,height:16,padding:0},children:(0,a.jsx)(E,{width:"14",height:"14"})})]})]})}function I(e){let{label:t,value:s,delta:n}=e;return(0,a.jsxs)("div",{className:"stat",style:{flexDirection:"column",gap:4,minWidth:0},children:[(0,a.jsx)("span",{className:"label",style:{fontSize:"11px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t}),(0,a.jsx)("span",{className:"value ".concat(n>0?"up":n<0?"down":""),style:{fontSize:"15px",lineHeight:1.2,whiteSpace:"nowrap"},children:s})]})}function B(e){let{onClose:t}=e,[s,l]=(0,n.useState)(!1),[r,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),m=async e=>{var t;e.preventDefault(),l(!0),d("");let s=new FormData(e.target);(null===(t=s.get("nickname"))||void 0===t?void 0:t.trim())||s.set("nickname","匿名"),s.append("access_key","b44bf783-0587-48a0-8161-8e5f184a3685"),s.append("subject","Junly-基金估值 - 用户反馈");try{let e=await fetch("https://api.web3forms.com/submit",{method:"POST",body:s}),t=await e.json();t.success?o(!0):d(t.message||"提交失败，请稍后再试")}catch(e){d("网络错误，请检查您的连接")}finally{l(!1)}};return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"意见反馈",onClick:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal feedback-modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"意见反馈"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:t,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),r?(0,a.jsxs)("div",{className:"success-message",style:{textAlign:"center",padding:"20px 0"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:16},children:"\uD83C\uDF89"}),(0,a.jsx)("h3",{style:{marginBottom:8},children:"感谢您的反馈！"}),(0,a.jsx)("p",{className:"muted",children:"我们已收到您的建议，会尽快查看。"}),(0,a.jsx)("button",{className:"button",onClick:t,style:{marginTop:24,width:"100%"},children:"关闭"})]}):(0,a.jsxs)("form",{onSubmit:m,className:"feedback-form",children:[(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsx)("label",{htmlFor:"nickname",className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:"您的昵称（可选）"}),(0,a.jsx)("input",{id:"nickname",type:"text",name:"nickname",className:"input",placeholder:"匿名",style:{width:"100%"}})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:20},children:[(0,a.jsx)("label",{htmlFor:"message",className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:"反馈内容"}),(0,a.jsx)("textarea",{id:"message",name:"message",className:"input",required:!0,placeholder:"请描述您遇到的问题或建议...",style:{width:"100%",minHeight:"120px",padding:"12px",resize:"vertical"}})]}),c&&(0,a.jsx)("div",{className:"error-text",style:{marginBottom:16,textAlign:"center"},children:c}),(0,a.jsx)("button",{className:"button",type:"submit",disabled:s,style:{width:"100%"},children:s?"发送中...":"提交反馈"})]})]})})}function D(e){let{fund:t,onClose:s,onAction:n}=e;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"持仓操作",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",onClick:e=>e.stopPropagation(),style:{maxWidth:"320px"},children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"持仓操作"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:s,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsxs)("div",{style:{marginBottom:20,textAlign:"center"},children:[(0,a.jsx)("div",{className:"fund-name",style:{fontWeight:600,fontSize:"16px",marginBottom:4},children:null==t?void 0:t.name}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px"},children:["#",null==t?void 0:t.code]})]}),(0,a.jsxs)("div",{className:"grid",style:{gap:12},children:[(0,a.jsx)("button",{hidden:!0,className:"button col-6",onClick:()=>n("buy"),style:{background:"rgba(34, 211, 238, 0.1)",border:"1px solid var(--primary)",color:"var(--primary)"},children:"加仓"}),(0,a.jsx)("button",{hidden:!0,className:"button col-6",onClick:()=>n("sell"),style:{background:"rgba(248, 113, 113, 0.1)",border:"1px solid var(--danger)",color:"var(--danger)"},children:"减仓"}),(0,a.jsx)("button",{className:"button col-12",onClick:()=>n("edit"),style:{background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"编辑持仓"}),(0,a.jsx)("button",{className:"button col-12",onClick:()=>n("clear"),style:{marginTop:8,background:"linear-gradient(180deg, #ef4444, #f87171)",border:"none",color:"#2b0b0b",fontWeight:600},children:"清空持仓"})]})]})})}function W(e){let{type:t,fund:s,onClose:l,onConfirm:r}=e,o="buy"===t,[c,d]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,p]=(0,n.useState)("0"),[x,g]=(0,n.useState)(new Date().toISOString().slice(0,10)),[y,j]=(0,n.useState)(new Date().getHours()>=15),[f,b]=(0,n.useState)(null),N=(null==s?void 0:s.estPricedCoverage)>.05?null==s?void 0:s.estGsz:"number"==typeof(null==s?void 0:s.gsz)?null==s?void 0:s.gsz:Number(null==s?void 0:s.dwjz);(0,n.useEffect)(()=>{if(!o)return;let e=parseFloat(m),t=parseFloat(h),s=parseFloat(N);e>0&&s>0&&!isNaN(t)?b(e/(1+t/100)/s):b(null)},[o,m,h,N]);let w=o?!!m&&!!h&&!!x&&null!==f:!!c&&!!N;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":o?"加仓":"减仓",onClick:l,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",onClick:e=>e.stopPropagation(),style:{maxWidth:"420px"},children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)("span",{style:{fontSize:"20px"},children:o?"\uD83D\uDCE5":"\uD83D\uDCE4"}),(0,a.jsx)("span",{children:o?"加仓":"减仓"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:l,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsxs)("div",{style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"fund-name",style:{fontWeight:600,fontSize:"16px",marginBottom:4},children:null==s?void 0:s.name}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px"},children:["#",null==s?void 0:s.code]})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),o)m&&h&&x&&null!==f&&N&&r({share:f,price:Number(N),totalCost:Number(m),date:x,isAfter3pm:y});else{if(!c||!N)return;r({share:Number(c),price:Number(N)})}},children:[o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["加仓金额 (\xa5) ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("div",{style:{border:m?"1px solid var(--border)":"1px solid var(--danger)",borderRadius:12},children:(0,a.jsx)(M,{value:m,onChange:u,step:100,min:0,placeholder:"请输入加仓金额"})})]}),(0,a.jsxs)("div",{className:"row",style:{gap:12,marginBottom:16},children:[(0,a.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["买入费率 (%) ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("div",{style:{border:h?"1px solid var(--border)":"1px solid var(--danger)",borderRadius:12},children:(0,a.jsx)(M,{value:h,onChange:p,step:.01,min:0,placeholder:"0.12"})})]}),(0,a.jsxs)("div",{className:"form-group",style:{flex:1},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["加仓日期 ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)(C,{value:x,onChange:g})]})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:12},children:[(0,a.jsx)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:"交易时段"}),(0,a.jsxs)("div",{className:"row",style:{gap:8,background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"4px"},children:[(0,a.jsx)("button",{type:"button",onClick:()=>j(!1),style:{flex:1,border:"none",background:y?"transparent":"var(--primary)",color:y?"var(--muted)":"#05263b",borderRadius:"6px",fontSize:"12px",cursor:"pointer",padding:"6px 8px"},children:"15:00前"}),(0,a.jsx)("button",{type:"button",onClick:()=>j(!0),style:{flex:1,border:"none",background:y?"var(--primary)":"transparent",color:y?"#05263b":"var(--muted)",borderRadius:"6px",fontSize:"12px",cursor:"pointer",padding:"6px 8px"},children:"15:00后"})]}),(0,a.jsx)("div",{className:"muted",style:{fontSize:"12px",marginTop:6},children:y?"将在下一个交易日确认份额":"将在当日确认份额"})]}),N&&null!==f&&(0,a.jsxs)("div",{className:"glass",style:{padding:"12px",borderRadius:"8px",background:"rgba(34, 211, 238, 0.05)",border:"1px solid rgba(34, 211, 238, 0.2)",marginBottom:8},children:[(0,a.jsxs)("div",{className:"row",style:{justifyContent:"space-between",marginBottom:4},children:[(0,a.jsx)("span",{className:"muted",style:{fontSize:"12px"},children:"预计确认份额"}),(0,a.jsxs)("span",{style:{fontWeight:700,color:"var(--primary)"},children:[f.toFixed(2)," 份"]})]}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px"},children:["计算基于当前净值/估值：\xa5",Number(N).toFixed(4)]})]})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["卖出份额 ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("div",{style:{border:c?"1px solid var(--border)":"1px solid var(--danger)",borderRadius:12},children:(0,a.jsx)(M,{value:c,onChange:d,step:1,min:0,placeholder:"请输入卖出份额"})})]})}),(0,a.jsxs)("div",{className:"row",style:{gap:12,marginTop:12},children:[(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:l,style:{flex:1,background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"取消"}),(0,a.jsx)("button",{type:"submit",className:"button",disabled:!w,style:{flex:1,opacity:w?1:.6},children:"确定"})]})]})]})})}function L(e){let{fund:t,holding:s,onClose:l,onSave:r}=e,[o,c]=(0,n.useState)("amount"),d=(null==t?void 0:t.dwjz)||(null==t?void 0:t.gsz)||0,[m,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[g,y]=(0,n.useState)(""),[j,f]=(0,n.useState)("");(0,n.useEffect)(()=>{if(s){let e=s.share||0,t=s.cost||0;if(u(String(e)),p(String(t)),d>0){let s=e*d,a=(d-t)*e;y(s.toFixed(2)),f(a.toFixed(2))}}},[s,t]);let b=e=>{if(e!==o){if(c(e),"share"===e){if(g&&d>0){let e=parseFloat(g),t=parseFloat(j||0),s=e/d;u(s.toFixed(2)),p((s>0?(e-t)/s:0).toFixed(4))}}else if(m&&d>0){let e=parseFloat(m),t=parseFloat(h||0),s=e*d,a=(d-t)*e;y(s.toFixed(2)),f(a.toFixed(2))}}},N="share"===o?m&&h&&!isNaN(m)&&!isNaN(h):g&&!isNaN(g)&&(!j||!isNaN(j))&&d>0;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"编辑持仓",onClick:l,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",onClick:e=>e.stopPropagation(),style:{maxWidth:"400px"},children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"设置持仓"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:l,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsxs)("div",{style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"fund-name",style:{fontWeight:600,fontSize:"16px",marginBottom:4},children:null==t?void 0:t.name}),(0,a.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px"},children:["#",null==t?void 0:t.code]}),(0,a.jsxs)("div",{className:"badge",style:{fontSize:"12px"},children:["最新净值：",(0,a.jsx)("span",{style:{fontWeight:600,color:"var(--primary)"},children:d})]})]})]}),(0,a.jsx)("div",{className:"tabs-container",style:{marginBottom:20,background:"rgba(255,255,255,0.05)",padding:4,borderRadius:12},children:(0,a.jsxs)("div",{className:"row",style:{gap:0},children:[(0,a.jsx)("button",{type:"button",className:"tab ".concat("amount"===o?"active":""),onClick:()=>b("amount"),style:{flex:1,justifyContent:"center",height:32,borderRadius:8},children:"按金额"}),(0,a.jsx)("button",{type:"button",className:"tab ".concat("share"===o?"active":""),onClick:()=>b("share"),style:{flex:1,justifyContent:"center",height:32,borderRadius:8},children:"按份额"})]})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=0,s=0;if("share"===o){if(!m||!h)return;t=Number(m),s=Number(h)}else{if(!g||!d)return;let e=Number(g),a=Number(j||0);s=(t=e/d)>0?(e-a)/t:0}r({share:t,cost:s}),l()},children:["amount"===o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["持有金额 ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("input",{type:"number",step:"any",className:"input ".concat(g?"":"error"),value:g,onChange:e=>y(e.target.value),placeholder:"请输入持有总金额",style:{width:"100%",border:g?void 0:"1px solid var(--danger)"}})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:24},children:[(0,a.jsx)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:"持有收益"}),(0,a.jsx)("input",{type:"number",step:"any",className:"input",value:j,onChange:e=>f(e.target.value),placeholder:"请输入持有总收益 (可为负)",style:{width:"100%"}})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["持有份额 ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("input",{type:"number",step:"any",className:"input ".concat(m?"":"error"),value:m,onChange:e=>u(e.target.value),placeholder:"请输入持有份额",style:{width:"100%",border:m?void 0:"1px solid var(--danger)"}})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:24},children:[(0,a.jsxs)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:["持仓成本价 ",(0,a.jsx)("span",{style:{color:"var(--danger)"},children:"*"})]}),(0,a.jsx)("input",{type:"number",step:"any",className:"input ".concat(h?"":"error"),value:h,onChange:e=>p(e.target.value),placeholder:"请输入持仓成本价",style:{width:"100%",border:h?void 0:"1px solid var(--danger)"}})]})]}),(0,a.jsxs)("div",{className:"row",style:{gap:12},children:[(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:l,style:{flex:1,background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"取消"}),(0,a.jsx)("button",{type:"submit",className:"button",disabled:!N,style:{flex:1,opacity:N?1:.6},children:"保存"})]})]})]})})}function F(e){let{failures:t,onClose:s}=e;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"添加结果",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"部分基金添加失败"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:s,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsx)("div",{className:"muted",style:{marginBottom:12,fontSize:"14px"},children:"未获取到估值数据的基金如下："}),(0,a.jsx)("div",{className:"list",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"item",children:[(0,a.jsx)("span",{className:"name",children:e.name||"未知名称"}),(0,a.jsx)("div",{className:"values",children:(0,a.jsxs)("span",{className:"badge",children:["#",e.code]})})]},t))}),(0,a.jsx)("div",{className:"row",style:{justifyContent:"flex-end",marginTop:16},children:(0,a.jsx)("button",{className:"button",onClick:s,children:"知道了"})})]})})}function T(e){let{message:t,onClose:s}=e;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"成功提示",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"success-message",style:{textAlign:"center",padding:"20px 0"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:16},children:"\uD83C\uDF89"}),(0,a.jsx)("h3",{style:{marginBottom:8},children:t}),(0,a.jsx)("p",{className:"muted",children:"操作已完成，您可以继续使用。"}),(0,a.jsx)("button",{className:"button",onClick:s,style:{marginTop:24,width:"100%"},children:"关闭"})]})})})}function A(e){let{title:t,message:s,onConfirm:n,onCancel:l,confirmText:r="确定删除"}=e;return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:l,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{zIndex:10002},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",style:{maxWidth:"400px"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(p,{width:"20",height:"20",className:"danger"}),(0,a.jsx)("span",{children:t})]}),(0,a.jsx)("p",{className:"muted",style:{marginBottom:24,fontSize:"14px",lineHeight:"1.6"},children:s}),(0,a.jsxs)("div",{className:"row",style:{gap:12},children:[(0,a.jsx)("button",{className:"button secondary",onClick:l,style:{flex:1,background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"取消"}),(0,a.jsx)("button",{className:"button danger",onClick:n,style:{flex:1},children:r})]})]})})}function O(e){let{groups:t,onClose:s,onSave:c}=e,[d,m]=(0,n.useState)(t),[u,g]=(0,n.useState)(null),y=(e,t)=>{let s=(t||"").slice(0,8);m(t=>t.map(t=>t.id===e?{...t,name:s}:t))},j=(e,s)=>{let a=d.find(t=>t.id===e),n=!t.find(t=>t.id===e),l=a&&(!a.codes||0===a.codes.length);n||l?m(t=>t.filter(t=>t.id!==e)):g({id:e,name:s})},f=d.every(e=>""!==e.name.trim());return(0,a.jsxs)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"管理分组",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",style:{maxWidth:"500px",width:"90vw"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"管理分组"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:s,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsxs)("div",{className:"group-manage-list-container",style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"4px"},children:[0===d.length?(0,a.jsxs)("div",{className:"empty-state muted",style:{textAlign:"center",padding:"40px 0"},children:[(0,a.jsx)("div",{style:{fontSize:"32px",marginBottom:12,opacity:.5},children:"\uD83D\uDCC2"}),(0,a.jsx)("p",{children:"暂无自定义分组"})]}):(0,a.jsx)(r.M,{axis:"y",values:d,onReorder:e=>{m(e)},className:"group-manage-list",children:(0,a.jsx)(l.M,{mode:"popLayout",children:d.map(e=>(0,a.jsxs)(o.e,{value:e,className:"group-manage-item glass",layout:!0,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{type:"spring",stiffness:500,damping:35,mass:1,layout:{duration:.2}},children:[(0,a.jsx)("div",{className:"drag-handle",style:{cursor:"grab",display:"flex",alignItems:"center",padding:"0 8px"},children:(0,a.jsx)(w,{width:"18",height:"18",className:"muted"})}),(0,a.jsx)("input",{className:"input group-rename-input ".concat(e.name.trim()?"":"error"),value:e.name,onChange:t=>y(e.id,t.target.value),placeholder:"请输入分组名称...",style:{flex:1,height:"36px",background:"rgba(0,0,0,0.2)",border:e.name.trim()?"none":"1px solid var(--danger)"}}),(0,a.jsx)("button",{className:"icon-button danger",onClick:()=>j(e.id,e.name),title:"删除分组",style:{width:"36px",height:"36px",flexShrink:0},children:(0,a.jsx)(p,{width:"16",height:"16"})})]},e.id))})}),(0,a.jsxs)("button",{className:"add-group-row-btn",onClick:()=>{let e={id:"group_".concat(Date.now()),name:"",codes:[]};m(t=>[...t,e])},style:{width:"100%",marginTop:12,padding:"10px",borderRadius:"12px",border:"1px dashed var(--border)",background:"rgba(255,255,255,0.02)",color:"var(--muted)",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,a.jsx)(h,{width:"16",height:"16"}),(0,a.jsx)("span",{children:"新增分组"})]})]}),(0,a.jsxs)("div",{style:{marginTop:24},children:[!f&&(0,a.jsx)("div",{className:"error-text",style:{marginBottom:12,textAlign:"center"},children:"所有分组名称均不能为空"}),(0,a.jsx)("button",{className:"button",onClick:()=>{d.some(e=>!e.name.trim())||(c(d),s())},disabled:!f,style:{width:"100%",opacity:f?1:.6},children:"完成"})]})]}),(0,a.jsx)(l.M,{children:u&&(0,a.jsx)(A,{title:"删除确认",message:'确定要删除分组 "'.concat(u.name,'" 吗？分组内的基金不会被删除。'),onConfirm:()=>{u&&(m(e=>e.filter(e=>e.id!==u.id)),g(null))},onCancel:()=>g(null)})})]})}function P(e){let{allFunds:t,currentGroupCodes:s,onClose:l,onAdd:r}=e,[o,c]=(0,n.useState)(new Set),d=(t||[]).filter(e=>!(s||[]).includes(e.code)),m=e=>{c(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})};return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:l,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",style:{maxWidth:"500px",width:"90vw"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(h,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"添加基金到分组"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:l,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsx)("div",{className:"group-manage-list-container",style:{maxHeight:"50vh",overflowY:"auto",paddingRight:"4px"},children:0===d.length?(0,a.jsx)("div",{className:"empty-state muted",style:{textAlign:"center",padding:"40px 0"},children:(0,a.jsx)("p",{children:"所有基金已在该分组中"})}):(0,a.jsx)("div",{className:"group-manage-list",children:d.map(e=>(0,a.jsxs)("div",{className:"group-manage-item glass ".concat(o.has(e.code)?"selected":""),onClick:()=>m(e.code),style:{cursor:"pointer"},children:[(0,a.jsx)("div",{className:"checkbox",style:{marginRight:12},children:o.has(e.code)&&(0,a.jsx)("div",{className:"checked-mark"})}),(0,a.jsxs)("div",{className:"fund-info",style:{flex:1},children:[(0,a.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px"},children:["#",e.code]})]})]},e.code))})}),(0,a.jsxs)("div",{className:"row",style:{marginTop:24,gap:12},children:[(0,a.jsx)("button",{className:"button secondary",onClick:l,style:{flex:1,background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"取消"}),(0,a.jsxs)("button",{className:"button",onClick:()=>r(Array.from(o)),disabled:0===o.size,style:{flex:1},children:["确定 (",o.size,")"]})]})]})})}function R(e){let{onClose:t,onConfirm:s}=e,[l,r]=(0,n.useState)("");return(0,a.jsx)(i.E.div,{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"新增分组",onClick:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",style:{maxWidth:"400px"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(h,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"新增分组"})]}),(0,a.jsx)("button",{className:"icon-button",onClick:t,style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:20},children:[(0,a.jsx)("label",{className:"muted",style:{display:"block",marginBottom:8,fontSize:"14px"},children:"分组名称（最多 8 个字）"}),(0,a.jsx)("input",{className:"input",autoFocus:!0,placeholder:"请输入分组名称...",value:l,onChange:e=>{r((e.target.value||"").slice(0,8))},onKeyDown:e=>{"Enter"===e.key&&l.trim()&&s(l.trim())}})]}),(0,a.jsxs)("div",{className:"row",style:{gap:12},children:[(0,a.jsx)("button",{className:"button secondary",onClick:t,style:{flex:1,background:"rgba(255,255,255,0.05)",color:"var(--text)"},children:"取消"}),(0,a.jsx)("button",{className:"button",onClick:()=>l.trim()&&s(l.trim()),disabled:!l.trim(),style:{flex:1},children:"确定"})]})]})})}function J(e){let{value:t,prefix:s="",suffix:l="",decimals:i=2,className:r="",style:o={}}=e,[c,d]=(0,n.useState)(t),m=(0,n.useRef)(t);return(0,n.useEffect)(()=>{if(m.current===t)return;let e=m.current,s=performance.now(),a=n=>{let l=Math.min((n-s)/1e3,1);d(e+(t-e)*(1-Math.pow(1-l,4))),l<1?requestAnimationFrame(a):m.current=t};requestAnimationFrame(a)},[t]),(0,a.jsxs)("span",{className:r,style:o,children:[s,Math.abs(c).toFixed(i),l]})}function _(e){let{funds:t,holdings:s,groupName:l,getProfit:i}=e,[r,o]=(0,n.useState)(!0),c=(0,n.useRef)(null),[d,m]=(0,n.useState)(24),[u,h]=(0,n.useState)(18),[p,x]=(0,n.useState)(0);(0,n.useEffect)(()=>{{x(window.innerWidth);let e=()=>x(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}},[]);let g=(0,n.useMemo)(()=>{let e=0,a=0,n=0,l=0,r=!1;t.forEach(t=>{let o=s[t.code],c=i(t,o);c&&(r=!0,e+=c.amount,a+=c.profitToday,null!==c.profitTotal&&(n+=c.profitTotal,o&&"number"==typeof o.cost&&"number"==typeof o.share&&(l+=o.cost*o.share)))});let o=l>0?n/l*100:0;return{totalAsset:e,totalProfitToday:a,totalHoldingReturn:n,hasHolding:r,returnRate:o}},[t,s,i]);return((0,n.useLayoutEffect)(()=>{let e=c.current;e&&e.clientHeight>80&&(m(e=>Math.max(16,e-1)),h(e=>Math.max(12,e-1)))},[p,g.totalAsset,g.totalProfitToday,g.totalHoldingReturn,g.returnRate,r,d,u]),g.hasHolding)?(0,a.jsx)("div",{className:"glass card",style:{marginBottom:16,padding:"16px 20px",background:"rgba(255, 255, 255, 0.03)"},children:(0,a.jsxs)("div",{ref:c,className:"row",style:{alignItems:"flex-end",justifyContent:"space-between"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"muted",style:{fontSize:"12px",marginBottom:4},children:l}),(0,a.jsxs)("div",{style:{fontSize:"24px",fontWeight:700,fontFamily:"var(--font-mono)"},children:[(0,a.jsx)("span",{style:{fontSize:"16px",marginRight:2},children:"\xa5"}),(0,a.jsx)(J,{value:g.totalAsset,style:{fontSize:d}})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:24},children:[(0,a.jsxs)("div",{style:{textAlign:"right"},children:[(0,a.jsx)("div",{className:"muted",style:{fontSize:"12px",marginBottom:4},children:"当日收益"}),(0,a.jsxs)("div",{className:g.totalProfitToday>0?"up":g.totalProfitToday<0?"down":"",style:{fontSize:"18px",fontWeight:700,fontFamily:"var(--font-mono)"},children:[(0,a.jsx)("span",{style:{marginRight:1},children:g.totalProfitToday>0?"+":g.totalProfitToday<0?"-":""}),(0,a.jsx)(J,{value:Math.abs(g.totalProfitToday),style:{fontSize:u}})]})]}),(0,a.jsxs)("div",{style:{textAlign:"right"},children:[(0,a.jsxs)("div",{className:"muted",style:{fontSize:"12px",marginBottom:4},children:["持有收益",r?"(%)":""]}),(0,a.jsxs)("div",{className:g.totalHoldingReturn>0?"up":g.totalHoldingReturn<0?"down":"",style:{fontSize:"18px",fontWeight:700,fontFamily:"var(--font-mono)",cursor:"pointer"},onClick:()=>o(!r),title:"点击切换金额/百分比",children:[(0,a.jsx)("span",{style:{marginRight:1},children:g.totalHoldingReturn>0?"+":g.totalHoldingReturn<0?"-":""}),r?(0,a.jsx)(J,{value:Math.abs(g.returnRate),suffix:"%",style:{fontSize:u}}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(J,{value:Math.abs(g.totalHoldingReturn),style:{fontSize:u}})})]})]})]})]})}):null}function H(){var e,t,s;let[r,o]=(0,n.useState)([]),[c,m]=(0,n.useState)(!1),[u,w]=(0,n.useState)(""),k=(0,n.useRef)(null),C=(0,n.useRef)(!1),[E,M]=(0,n.useState)(3e4),[J,H]=(0,n.useState)(!1),[q,G]=(0,n.useState)(30),[Y,$]=(0,n.useState)(!1),[U,V]=(0,n.useState)(new Set),[X,K]=(0,n.useState)(new Set),[Z,Q]=(0,n.useState)([]),[ee,et]=(0,n.useState)("all"),[es,ea]=(0,n.useState)(!1),[en,el]=(0,n.useState)(!1),[ei,er]=(0,n.useState)(!1),[eo,ec]=(0,n.useState)(null),[ed,em]=(0,n.useState)("default"),[eu,eh]=(0,n.useState)("desc"),[ep,ex]=(0,n.useState)("card"),[eg,ey]=(0,n.useState)(!1),[ej,ef]=(0,n.useState)(0),[ev,eb]=(0,n.useState)(""),[eN,ew]=(0,n.useState)([]),[eS,ek]=(0,n.useState)([]),[eC,ez]=(0,n.useState)(!1),eE=(0,n.useRef)(null),eM=(0,n.useRef)(null),[eI,eB]=(0,n.useState)(!1),[eD,eW]=(0,n.useState)(!1),[eL,eF]=(0,n.useState)([]),[eT,eA]=(0,n.useState)({open:!1,fund:null}),[eO,eP]=(0,n.useState)({open:!1,fund:null}),[eR,eJ]=(0,n.useState)({open:!1,fund:null,type:"buy"}),[e_,eH]=(0,n.useState)(null),[eq,eG]=(0,n.useState)(!1),[eY,e$]=(0,n.useState)({}),[eU,eV]=(0,n.useState)({}),[eX,eK]=(0,n.useState)(!0),eZ=(0,n.useRef)(null),[eQ,e0]=(0,n.useState)(null),e1=new Date,e2="".concat(e1.getFullYear(),"-").concat(String(e1.getMonth()+1).padStart(2,"0"),"-").concat(String(e1.getDate()).padStart(2,"0")),[e5,e4]=(0,n.useState)(!1);(0,n.useEffect)(()=>{{let e=()=>e4(window.innerWidth<=640);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}},[]);let[e8,e6]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=e=>{!e.target.closest(".swipe-action-bg")&&e8&&e6(null)};return e8&&(document.addEventListener("click",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("click",e),document.removeEventListener("touchstart",e)}},[e8]);let e3=()=>{let e=new Date,t=0===e.getDay()||6===e.getDay();if(t){eK(!1);return}let s=document.createElement("script");s.src="https://qt.gtimg.cn/q=sh000001&_t=".concat(Date.now()),s.onload=()=>{let t=window.v_sh000001;if(t){let s=t.split("~");s.length>30&&(s[30].slice(0,8)===e2.replace(/-/g,"")?eK(!0):60*e.getHours()+e.getMinutes()>=570?eK(!1):eK(!0))}document.body.removeChild(s)},s.onerror=()=>{document.body.removeChild(s),eK(!t)},document.body.appendChild(s)};(0,n.useEffect)(()=>{e3();let e=setInterval(e3,6e4);return()=>clearInterval(e)},[]);let e7=(e,t)=>{let s,a;if(!t||"number"!=typeof t.share)return null;let n=new Date().getHours()>=9,l=e.jzrq===e2;if(eX&&n&&!l){if(!(s=e.estPricedCoverage>.05?e.estGsz:"number"==typeof e.gsz?e.gsz:Number(e.dwjz)))return null;let n=t.share*s;a=n-n/(1+(e.estPricedCoverage>.05?e.estGszzl:Number(e.gszzl)||0)/100)}else{if(!(s=Number(e.dwjz)))return null;let n=t.share*s;a=n-n/(1+(void 0!==e.zzl?Number(e.zzl):Number(e.gszzl)||0)/100)}return{amount:t.share*s,profitToday:a,profitTotal:"number"==typeof t.cost?(s-t.cost)*t.share:null}},e9=r.filter(e=>{if("all"===ee)return!0;if("fav"===ee)return X.has(e.code);let t=Z.find(e=>e.id===ee);return!t||t.codes.includes(e.code)}).sort((e,t)=>{if("yield"===ed){let s="number"==typeof e.estGszzl?e.estGszzl:Number(e.gszzl)||0,a="number"==typeof t.estGszzl?t.estGszzl:Number(t.gszzl)||0;return"asc"===eu?s-a:a-s}if("holding"===ed){var s,a;let n=e7(e,eY[e.code]),l=e7(t,eY[t.code]),i=null!==(s=null==n?void 0:n.profitTotal)&&void 0!==s?s:Number.NEGATIVE_INFINITY,r=null!==(a=null==l?void 0:l.profitTotal)&&void 0!==a?a:Number.NEGATIVE_INFINITY;return"asc"===eu?i-r:r-i}return"name"===ed?"asc"===eu?e.name.localeCompare(t.name,"zh-CN"):t.name.localeCompare(e.name,"zh-CN"):0});(0,n.useEffect)(()=>{if(!eZ.current)return;if("all"===ee){eZ.current.scrollTo({left:0,behavior:"smooth"});return}let e=eZ.current.querySelector(".tab.active");e&&e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})},[ee]);let[te,tt]=(0,n.useState)(!1),[ts,ta]=(0,n.useState)(!1),[tn,tl]=(0,n.useState)(!1),[ti,tr]=(0,n.useState)(!1),to=(e,t)=>{e$(s=>{let a={...s};return null===t.share&&null===t.cost?delete a[e]:a[e]=t,localStorage.setItem("holdings",JSON.stringify(a)),a}),eA({open:!1,fund:null})},tc=(e,t)=>{eP({open:!1,fund:null}),"edit"===e?eA({open:!0,fund:t}):"clear"===e?eH({fund:t}):("buy"===e||"sell"===e)&&eJ({open:!0,fund:t,type:e})},td=(e,t)=>{let s,a;let n=eY[e.code]||{share:0,cost:0};if("buy"===eR.type){s=n.share+t.share;let e=void 0!==t.totalCost?t.totalCost:t.price*t.share;a=(n.cost*n.share+e)/s}else s=Math.max(0,n.share-t.share),a=n.cost,0===s&&(a=0);to(e.code,{share:s,cost:a}),eJ({open:!1,fund:null,type:"buy"})},tm=()=>{tt(!1)},tu=()=>{if(!eZ.current)return;let e=eZ.current;ta(e.scrollWidth>e.clientWidth),tl(e.scrollLeft>0),tr(e.scrollLeft<e.scrollWidth-e.clientWidth-1)};(0,n.useEffect)(()=>{tu();let e=()=>tu();return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[Z,r.length,X.size]);let[th,tp]=(0,n.useState)({open:!1,message:""});(0,n.useEffect)(()=>{let e=e=>{eM.current&&!eM.current.contains(e.target)&&eB(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let tx=e=>{K(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),localStorage.setItem("favorites",JSON.stringify(Array.from(s))),0===s.size&&et("all"),s})},tg=e=>{V(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),localStorage.setItem("expandedCodes",JSON.stringify(Array.from(s))),s})},ty=e=>{let t=Z.map(t=>t.id===ee?{...t,codes:t.codes.filter(t=>t!==e)}:t);Q(t),localStorage.setItem("groups",JSON.stringify(t))},tj=e=>{let t=new Set;return e.filter(e=>{let s=null==e?void 0:e.code;return!(!s||t.has(s))&&(t.add(s),!0)})};(0,n.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("funds")||"[]");if(Array.isArray(e)&&e.length){let t=tj(e);o(t),localStorage.setItem("funds",JSON.stringify(t));let s=Array.from(new Set(t.map(e=>e.code)));s.length&&tw(s)}let t=parseInt(localStorage.getItem("refreshMs")||"30000",10);Number.isFinite(t)&&t>=5e3&&(M(t),G(Math.round(t/1e3)));let s=JSON.parse(localStorage.getItem("expandedCodes")||"[]");Array.isArray(s)&&V(new Set(s));let a=JSON.parse(localStorage.getItem("favorites")||"[]");Array.isArray(a)&&K(new Set(a));let n=JSON.parse(localStorage.getItem("groups")||"[]");Array.isArray(n)&&Q(n);let l=localStorage.getItem("viewMode");("card"===l||"list"===l)&&ex(l);let i=JSON.parse(localStorage.getItem("holdings")||"{}");i&&"object"==typeof i&&e$(i)}catch(e){}},[]),(0,n.useEffect)(()=>(k.current&&clearInterval(k.current),k.current=setInterval(()=>{let e=Array.from(new Set(r.map(e=>e.code)));e.length&&tw(e)},E),()=>{k.current&&clearInterval(k.current)}),[r,E]);let tf=e=>new Promise((t,s)=>{let a=document.createElement("script");a.src=e,a.async=!0,a.onload=()=>{document.body.removeChild(a),t()},a.onerror=()=>{document.body.removeChild(a),s(Error("数据加载失败"))},document.body.appendChild(a)}),tv=async e=>new Promise(async(t,s)=>{let a="https://fundgz.1234567.com.cn/js/".concat(e,".js?rt=").concat(Date.now());"jsonpgz_".concat(e,"_").concat(Math.random().toString(36).slice(2,7));let n=document.createElement("script");n.src=a;let l=window.jsonpgz;window.jsonpgz=a=>{if(window.jsonpgz=l,!a||"object"!=typeof a){s(Error("未获取到基金估值数据"));return}let n=Number(a.gszzl),i={code:a.fundcode,name:a.name,dwjz:a.dwjz,gsz:a.gsz,gztime:a.gztime,jzrq:a.jzrq,gszzl:Number.isFinite(n)?n:a.gszzl};Promise.all([new Promise(t=>{let s=document.createElement("script");s.src="https://qt.gtimg.cn/q=jj".concat(e),s.onload=()=>{let a=window["v_jj".concat(e)];if(a){let e=a.split("~");t({dwjz:e[5],zzl:parseFloat(e[7]),jzrq:e[8]?e[8].slice(0,10):""})}else t(null);document.body.contains(s)&&document.body.removeChild(s)},s.onerror=()=>{document.body.contains(s)&&document.body.removeChild(s),t(null)},document.body.appendChild(s)}),new Promise(t=>{tf("https://fundf10.eastmoney.com/FundArchivesDatas.aspx?type=jjcc&code=".concat(e,"&topline=10&year=&month=&_=").concat(Date.now())).then(async()=>{var e,s;let a=[],n=(null===(e=window.apidata)||void 0===e?void 0:e.content)||"",l=(((n.match(/<thead[\s\S]*?<tr[\s\S]*?<\/tr>[\s\S]*?<\/thead>/i)||[])[0]||"").match(/<th[\s\S]*?>([\s\S]*?)<\/th>/gi)||[]).map(e=>e.replace(/<[^>]*>/g,"").trim()),i=-1,r=-1,o=-1;l.forEach((e,t)=>{let s=e.replace(/\s+/g,"");i<0&&(s.includes("股票代码")||s.includes("证券代码"))&&(i=t),r<0&&(s.includes("股票名称")||s.includes("证券名称"))&&(r=t),o<0&&(s.includes("占净值比例")||s.includes("占比"))&&(o=t)});let c=n.match(/<tbody[\s\S]*?<\/tbody>/i)||[];for(let e of c.length?c[0].match(/<tr[\s\S]*?<\/tr>/gi)||[]:n.match(/<tr[\s\S]*?<\/tr>/gi)||[]){let t=(e.match(/<td[\s\S]*?>([\s\S]*?)<\/td>/gi)||[]).map(e=>e.replace(/<[^>]*>/g,"").trim());if(!t.length)continue;let n="",l="",c="";if(i>=0&&t[i]){let e=t[i].match(/(\d{6})/);n=e?e[1]:t[i]}else{let e=t.findIndex(e=>/^\d{6}$/.test(e));e>=0&&(n=t[e])}if(r>=0&&t[r])l=t[r];else if(n){let e=t.findIndex(e=>e&&e!==n&&!/%$/.test(e));l=e>=0?t[e]:""}if(o>=0&&t[o]){let e=t[o].match(/([\d.]+)\s*%/);c=e?"".concat(e[1],"%"):t[o]}else{let e=t.findIndex(e=>/\d+(?:\.\d+)?\s*%/.test(e));c=e>=0?(null===(s=t[e].match(/([\d.]+)\s*%/))||void 0===s?void 0:s[1])+"%":""}(n||l||c)&&a.push({code:n,name:l,weight:c,change:null})}let d=(a=a.slice(0,10)).filter(e=>/^\d{6}$/.test(e.code)||/^\d{5}$/.test(e.code));if(d.length)try{let e=d.map(e=>{let t=String(e.code||"");if(/^\d{6}$/.test(t)){let e=t.startsWith("6")||t.startsWith("9")?"sh":t.startsWith("4")||t.startsWith("8")?"bj":"sz";return"s_".concat(e).concat(t)}return/^\d{5}$/.test(t)?"s_hk".concat(t):null}).filter(Boolean).join(",");if(!e){t(a);return}let s="https://qt.gtimg.cn/q=".concat(e);await new Promise(e=>{let t=document.createElement("script");t.src=s,t.onload=()=>{d.forEach(e=>{let t=String(e.code||""),s="";if(/^\d{6}$/.test(t)){let e=t.startsWith("6")||t.startsWith("9")?"sh":t.startsWith("4")||t.startsWith("8")?"bj":"sz";s="v_s_".concat(e).concat(t)}else{if(!/^\d{5}$/.test(t))return;s="v_s_hk".concat(t)}let a=window[s];if(a){let t=a.split("~");t.length>5&&(e.change=parseFloat(t[5]))}}),document.body.contains(t)&&document.body.removeChild(t),e()},t.onerror=()=>{document.body.contains(t)&&document.body.removeChild(t),e()},document.body.appendChild(t)})}catch(e){}t(a)}).catch(()=>t([]))})]).then(e=>{let[s,a]=e;s&&s.jzrq&&(!i.jzrq||s.jzrq>=i.jzrq)&&(i.dwjz=s.dwjz,i.jzrq=s.jzrq,i.zzl=s.zzl),t({...i,holdings:a})})},n.onerror=()=>{window.jsonpgz=l,document.body.contains(n)&&document.body.removeChild(n),s(Error("基金数据加载失败"))},document.body.appendChild(n),setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},5e3)}),tb=async e=>{if(!e.trim()){ew([]);return}ez(!0);let t="SuggestData_".concat(Date.now()),s="https://fundsuggest.eastmoney.com/FundSearch/api/FundSearchAPI.ashx?m=1&key=".concat(encodeURIComponent(e),"&callback=").concat(t,"&_=").concat(Date.now());try{await new Promise((e,a)=>{window[t]=s=>{if(s&&s.Datas){let e=s.Datas.filter(e=>700===e.CATEGORY||"700"===e.CATEGORY||"基金"===e.CATEGORYDESC);ew(e)}delete window[t],e()};let n=document.createElement("script");n.src=s,n.async=!0,n.onload=()=>{document.body.contains(n)&&document.body.removeChild(n)},n.onerror=()=>{document.body.contains(n)&&document.body.removeChild(n),delete window[t],a(Error("搜索请求失败"))},document.body.appendChild(n)})}catch(e){console.error("搜索失败",e)}finally{ez(!1)}},tN=e=>{ek(t=>t.find(t=>t.CODE===e.CODE)?t.filter(t=>t.CODE!==e.CODE):[...t,e])},tw=async e=>{if(C.current)return;C.current=!0,$(!0);let t=Array.from(new Set(e));try{let e=[];for(let s of t)try{let t=await tv(s);e.push(t)}catch(t){console.error("刷新基金 ".concat(s," 失败"),t),o(t=>{let a=t.find(e=>e.code===s);return a&&e.push(a),t})}e.length>0&&o(t=>{let s=[...t];e.forEach(e=>{let t=s.findIndex(t=>t.code===e.code);t>-1?s[t]=e:s.push(e)});let a=tj(s);return localStorage.setItem("funds",JSON.stringify(a)),a})}catch(e){console.error(e)}finally{C.current=!1,$(!1)}},tS=e=>{let t=eY[e.code];t&&"number"==typeof t.share&&t.share>0?e0({code:e.code,name:e.name}):tC(e.code)},tk=async e=>{var t;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),w("");let s=String(ev||"").split(/[^0-9A-Za-z]+/).map(e=>e.trim()).filter(e=>e.length>0),a=Array.from(new Set([...eS.map(e=>e.CODE),...s.filter(e=>/^\d{6}$/.test(e))]));if(0===a.length){w("请输入或选择基金代码");return}m(!0);try{let e=[],t=[],s={};for(let n of(eS.forEach(e=>{s[e.CODE]=e.NAME}),a))if(!r.some(e=>e.code===n))try{let t=await tv(n);e.push(t)}catch(e){t.push({code:n,name:s[n]})}if(0===e.length)w("未添加任何新基金");else{let t=tj([...e,...r]);o(t),localStorage.setItem("funds",JSON.stringify(t))}eb(""),ek([]),eB(!1),t.length>0&&(eF(t),eW(!0))}catch(e){w(e.message||"添加失败")}finally{m(!1)}},tC=e=>{let t=r.filter(t=>t.code!==e);o(t),localStorage.setItem("funds",JSON.stringify(t));let s=Z.map(t=>({...t,codes:t.codes.filter(t=>t!==e)}));Q(s),localStorage.setItem("groups",JSON.stringify(s)),V(t=>{if(!t.has(e))return t;let s=new Set(t);return s.delete(e),localStorage.setItem("expandedCodes",JSON.stringify(Array.from(s))),s}),K(t=>{if(!t.has(e))return t;let s=new Set(t);return s.delete(e),localStorage.setItem("favorites",JSON.stringify(Array.from(s))),0===s.size&&et("all"),s}),e$(t=>{if(!t[e])return t;let s={...t};return delete s[e],localStorage.setItem("holdings",JSON.stringify(s)),s})},tz=async()=>{if(C.current)return;let e=Array.from(new Set(r.map(e=>e.code)));e.length&&await tw(e)},tE=(0,n.useRef)(null),[tM,tI]=(0,n.useState)(""),tB=async()=>{try{let e={version:1,funds:JSON.parse(localStorage.getItem("funds")||"[]"),favorites:JSON.parse(localStorage.getItem("favorites")||"[]"),groups:JSON.parse(localStorage.getItem("groups")||"[]"),expandedCodes:JSON.parse(localStorage.getItem("expandedCodes")||"[]"),refreshMs:parseInt(localStorage.getItem("refreshMs")||"30000",10),viewMode:localStorage.getItem("viewMode")||"card",holdings:JSON.parse(localStorage.getItem("holdings")||"{}"),exportedAt:new Date().toISOString()},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});if(window.showSaveFilePicker){let e=await window.showSaveFilePicker({suggestedName:"realtime-fund-config-".concat(Date.now(),".json"),types:[{description:"JSON",accept:{"application/json":[".json"]}}]}),s=await e.createWritable();await s.write(t),await s.close(),tp({open:!0,message:"导出成功"}),H(!1);return}let s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="realtime-fund-config-".concat(Date.now(),".json");let n=!1,l=()=>{n||(n=!0,URL.revokeObjectURL(s),tp({open:!0,message:"导出成功"}),H(!1))},i=()=>{"hidden"!==document.visibilityState&&(l(),document.removeEventListener("visibilitychange",i))};document.addEventListener("visibilitychange",i,{once:!0}),a.click(),setTimeout(l,3e3)}catch(e){console.error("Export error:",e)}},tD=async e=>{try{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!s)return;let a=await s.text(),n=JSON.parse(a);if(n&&"object"==typeof n){let e=JSON.parse(localStorage.getItem("funds")||"[]"),t=JSON.parse(localStorage.getItem("favorites")||"[]"),s=JSON.parse(localStorage.getItem("groups")||"[]"),a=JSON.parse(localStorage.getItem("expandedCodes")||"[]"),l=e,i=[];if(Array.isArray(n.funds)){let t=tj(n.funds),s=new Set(e.map(e=>e.code)),a=t.filter(e=>e&&e.code&&!s.has(e.code));i=a.map(e=>e.code),l=[...e,...a],o(l),localStorage.setItem("funds",JSON.stringify(l))}if(Array.isArray(n.favorites)){let e=Array.from(new Set([...t,...n.favorites]));K(new Set(e)),localStorage.setItem("favorites",JSON.stringify(e))}if(Array.isArray(n.groups)){let e=[...s];n.groups.forEach(t=>{let s=e.findIndex(e=>e.id===t.id);s>-1?e[s]={...e[s],codes:Array.from(new Set([...e[s].codes,...t.codes||[]]))}:e.push(t)}),Q(e),localStorage.setItem("groups",JSON.stringify(e))}if(Array.isArray(n.expandedCodes)){let e=Array.from(new Set([...a,...n.expandedCodes]));V(new Set(e)),localStorage.setItem("expandedCodes",JSON.stringify(e))}if("number"==typeof n.refreshMs&&n.refreshMs>=5e3&&(M(n.refreshMs),G(Math.round(n.refreshMs/1e3)),localStorage.setItem("refreshMs",String(n.refreshMs))),("card"===n.viewMode||"list"===n.viewMode)&&(ex(n.viewMode),localStorage.setItem("viewMode",n.viewMode)),n.holdings&&"object"==typeof n.holdings){let e={...JSON.parse(localStorage.getItem("holdings")||"{}"),...n.holdings};e$(e),localStorage.setItem("holdings",JSON.stringify(e))}if(i.length){let e=l.map(e=>e.code);await tw(e)}tp({open:!0,message:"导入成功"}),H(!1),tE.current&&(tE.current.value="")}}catch(e){console.error("Import error:",e),tI("导入失败，请检查文件格式"),setTimeout(()=>tI(""),4e3),tE.current&&(tE.current.value="")}};return(0,n.useEffect)(()=>(J||eg||eD||ei||en||es||th.open||eT.open||eO.open||eR.open||e_||eq||eQ?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[J,eg,eD,ei,en,es,th.open,eT.open,eO.open,eR.open,e_,eq]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&J&&H(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[J]),(0,a.jsxs)("div",{className:"container content",children:[(0,a.jsx)(d,{}),(0,a.jsxs)("div",{className:"navbar glass",children:[Y&&(0,a.jsx)("div",{className:"loading-bar"}),(0,a.jsxs)("div",{className:"brand",children:[(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("path",{d:"M22 7L13.5 15.5L8.5 10.5L2 17",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M16 7H22V13",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M2 20H22",stroke:"var(--accent)",strokeWidth:"2",strokeLinecap:"round"})]}),(0,a.jsx)("span",{children:"Junly-基金估值"})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsx)("img",{alt:"项目Github地址",src:"/fund/_next/static/media/website.666f5e12.svg",style:{width:"30px",height:"30px",cursor:"pointer"},onClick:()=>window.open("https://junly.top")}),(0,a.jsxs)("div",{className:"badge",title:"当前刷新频率",children:[(0,a.jsx)("span",{children:"刷新"}),(0,a.jsxs)("strong",{children:[Math.round(E/1e3),"秒"]})]}),(0,a.jsx)("button",{className:"icon-button","aria-label":"立即刷新",onClick:tz,disabled:Y||0===r.length,"aria-busy":Y,title:"立即刷新",children:(0,a.jsx)(g,{className:Y?"spin":"",width:"18",height:"18"})}),(0,a.jsx)("button",{className:"icon-button","aria-label":"打开设置",onClick:()=>H(!0),title:"设置",children:(0,a.jsx)(x,{width:"18",height:"18"})})]})]}),(0,a.jsxs)("div",{className:"grid",children:[(0,a.jsxs)("div",{className:"col-12 glass card add-fund-section",role:"region","aria-label":"添加基金",children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(h,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"添加基金"}),(0,a.jsx)("span",{className:"muted",children:"搜索并选择基金（支持名称或代码）"})]}),(0,a.jsxs)("div",{className:"search-container",ref:eM,children:[(0,a.jsxs)("form",{className:"form",onSubmit:tk,children:[(0,a.jsxs)("div",{className:"search-input-wrapper",style:{flex:1,gap:8,alignItems:"center",flexWrap:"wrap"},children:[eS.length>0&&(0,a.jsx)("div",{className:"selected-inline-chips",children:eS.map(e=>(0,a.jsxs)("div",{className:"fund-chip",children:[(0,a.jsx)("span",{children:e.NAME}),(0,a.jsx)("button",{onClick:()=>tN(e),className:"remove-chip",children:(0,a.jsx)(v,{width:"14",height:"14"})})]},e.CODE))}),(0,a.jsx)("input",{className:"input",placeholder:"搜索基金名称或代码...",value:ev,onChange:e=>{let t=e.target.value;eb(t),eE.current&&clearTimeout(eE.current),eE.current=setTimeout(()=>tb(t),300)},onFocus:()=>eB(!0)}),eC&&(0,a.jsx)("div",{className:"search-spinner"})]}),(0,a.jsx)("button",{className:"button",type:"submit",disabled:c,children:c?"添加中…":"添加"})]}),(0,a.jsx)(l.M,{children:eI&&(ev.trim()||eN.length>0)&&(0,a.jsx)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"search-dropdown glass",children:eN.length>0?(0,a.jsx)("div",{className:"search-results",children:eN.map(e=>{let t=eS.some(t=>t.CODE===e.CODE),s=r.some(t=>t.code===e.CODE);return(0,a.jsxs)("div",{className:"search-item ".concat(t?"selected":""," ").concat(s?"added":""),onClick:()=>{s||tN(e)},children:[(0,a.jsxs)("div",{className:"fund-info",children:[(0,a.jsx)("span",{className:"fund-name",children:e.NAME}),(0,a.jsxs)("span",{className:"fund-code muted",children:["#",e.CODE," | ",e.TYPE]})]}),s?(0,a.jsx)("span",{className:"added-label",children:"已添加"}):(0,a.jsx)("div",{className:"checkbox",children:t&&(0,a.jsx)("div",{className:"checked-mark"})})]},e.CODE)})}):ev.trim()&&!eC?(0,a.jsx)("div",{className:"no-results muted",children:"未找到相关基金"}):null})})]}),u&&(0,a.jsx)("div",{className:"muted",style:{marginTop:8,color:"var(--danger)"},children:u})]}),(0,a.jsxs)("div",{className:"col-12",children:[(0,a.jsxs)("div",{className:"filter-bar",style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,a.jsxs)("div",{className:"tabs-container",children:[(0,a.jsx)("div",{className:"tabs-scroll-area","data-mask-left":tn,"data-mask-right":ti,children:(0,a.jsx)("div",{className:"tabs",ref:eZ,onMouseDown:e=>{eZ.current&&tt(!0)},onMouseLeave:tm,onMouseUp:tm,onMouseMove:e=>{te&&eZ.current&&(e.preventDefault(),eZ.current.scrollLeft-=e.movementX)},onWheel:e=>{if(!eZ.current)return;let t=Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.deltaX:e.deltaY;eZ.current.scrollLeft+=t},onScroll:tu,children:(0,a.jsxs)(l.M,{mode:"popLayout",children:[(0,a.jsxs)(i.E.button,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"tab ".concat("all"===ee?"active":""),onClick:()=>et("all"),transition:{type:"spring",stiffness:500,damping:30,mass:1},children:["全部 (",r.length,")"]},"all"),(0,a.jsxs)(i.E.button,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"tab ".concat("fav"===ee?"active":""),onClick:()=>et("fav"),transition:{type:"spring",stiffness:500,damping:30,mass:1},children:["自选 (",X.size,")"]},"fav"),Z.map(e=>(0,a.jsxs)(i.E.button,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"tab ".concat(ee===e.id?"active":""),onClick:()=>et(e.id),transition:{type:"spring",stiffness:500,damping:30,mass:1},children:[e.name," (",e.codes.length,")"]},e.id))]})})}),Z.length>0&&(0,a.jsx)("button",{className:"icon-button manage-groups-btn",onClick:()=>el(!0),title:"管理分组",children:(0,a.jsx)(j,{width:"16",height:"16"})}),(0,a.jsx)("button",{className:"icon-button add-group-btn",onClick:()=>ea(!0),title:"新增分组",children:(0,a.jsx)(h,{width:"16",height:"16"})})]}),(0,a.jsxs)("div",{className:"sort-group",style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsxs)("div",{className:"view-toggle",style:{display:"flex",background:"rgba(255,255,255,0.05)",borderRadius:"10px",padding:"2px"},children:[(0,a.jsx)("button",{className:"icon-button ".concat("card"===ep?"active":""),onClick:()=>{ex("card"),localStorage.setItem("viewMode","card")},style:{border:"none",width:"32px",height:"32px",background:"card"===ep?"var(--primary)":"transparent",color:"card"===ep?"#05263b":"var(--muted)"},title:"卡片视图",children:(0,a.jsx)(f,{width:"16",height:"16"})}),(0,a.jsx)("button",{className:"icon-button ".concat("list"===ep?"active":""),onClick:()=>{ex("list"),localStorage.setItem("viewMode","list")},style:{border:"none",width:"32px",height:"32px",background:"list"===ep?"var(--primary)":"transparent",color:"list"===ep?"#05263b":"var(--muted)"},title:"表格视图",children:(0,a.jsx)(N,{width:"16",height:"16"})})]}),(0,a.jsx)("div",{className:"divider",style:{width:"1px",height:"20px",background:"var(--border)"}}),(0,a.jsxs)("div",{className:"sort-items",style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsxs)("span",{className:"muted",style:{fontSize:"12px",display:"flex",alignItems:"center",gap:4},children:[(0,a.jsx)(j,{width:"14",height:"14"}),"排序"]}),(0,a.jsx)("div",{className:"chips",children:[{id:"default",label:"默认"},{id:"yield",label:"涨跌幅"},{id:"holding",label:"持有收益"},{id:"name",label:"名称"}].map(e=>(0,a.jsxs)("button",{className:"chip ".concat(ed===e.id?"active":""),onClick:()=>{ed===e.id?eh(e=>"asc"===e?"desc":"asc"):(em(e.id),eh("desc"))},style:{height:"28px",fontSize:"12px",padding:"0 10px",display:"flex",alignItems:"center",gap:4},children:[(0,a.jsx)("span",{children:e.label}),"default"!==e.id&&ed===e.id&&(0,a.jsxs)("span",{style:{display:"inline-flex",flexDirection:"column",lineHeight:1,fontSize:"8px"},children:[(0,a.jsx)("span",{style:{opacity:"asc"===eu?1:.3},children:"▲"}),(0,a.jsx)("span",{style:{opacity:"desc"===eu?1:.3},children:"▼"})]})]},e.id))})]})]})]}),0===e9.length?(0,a.jsxs)("div",{className:"glass card empty",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:16,opacity:.5},children:"\uD83D\uDCC2"}),(0,a.jsx)("div",{className:"muted",style:{marginBottom:20},children:0===r.length?"尚未添加基金":"该分组下暂无数据"}),"all"!==ee&&"fav"!==ee&&r.length>0&&(0,a.jsx)("button",{className:"button",onClick:()=>er(!0),children:"添加基金到此分组"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_,{funds:e9,holdings:eY,groupName:(()=>{if("all"===ee)return"全部资产";if("fav"===ee)return"自选资产";let e=Z.find(e=>e.id===ee);return e?"".concat(e.name,"资产"):"分组资产"})(),getProfit:e7}),"all"!==ee&&"fav"!==ee&&(0,a.jsxs)(i.E.button,{initial:{opacity:0},animate:{opacity:1},className:"button-dashed",onClick:()=>er(!0),style:{width:"100%",height:"48px",border:"2px dashed rgba(255,255,255,0.1)",background:"transparent",borderRadius:"12px",color:"var(--muted)",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"16px",cursor:"pointer",transition:"all 0.2s ease",fontSize:"14px",fontWeight:500},onMouseEnter:e=>{e.currentTarget.style.borderColor="var(--primary)",e.currentTarget.style.color="var(--primary)",e.currentTarget.style.background="rgba(34, 211, 238, 0.05)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="rgba(255,255,255,0.1)",e.currentTarget.style.color="var(--muted)",e.currentTarget.style.background="transparent"},children:[(0,a.jsx)(h,{width:"18",height:"18"}),(0,a.jsx)("span",{children:"添加基金到此分组"})]}),(0,a.jsx)(l.M,{mode:"wait",children:(0,a.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card"===ep?"grid":"table-container glass",children:(0,a.jsxs)("div",{className:"card"===ep?"grid col-12":"",style:"card"===ep?{gridColumn:"span 12",gap:16}:{},children:["list"===ep&&(0,a.jsxs)("div",{className:"table-header-row",children:[(0,a.jsx)("div",{className:"table-header-cell",children:"基金名称"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"净值/估值"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"涨跌幅"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"估值时间"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"持仓金额"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"当日盈亏"}),(0,a.jsx)("div",{className:"table-header-cell text-right",children:"持有收益"}),(0,a.jsx)("div",{className:"table-header-cell text-center",children:"操作"})]}),(0,a.jsx)(l.M,{mode:"popLayout",children:e9.map(e=>{var t,s,n;return(0,a.jsxs)(i.E.div,{layout:"position",className:"card"===ep?"col-6":"table-row-wrapper",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},style:{position:"relative",overflow:"hidden"},children:["list"===ep&&e5&&(0,a.jsxs)("div",{className:"swipe-action-bg",onClick:t=>{t.stopPropagation(),Y||tS(e)},style:{pointerEvents:Y?"none":"auto",opacity:Y?.6:1},children:[(0,a.jsx)(p,{width:"18",height:"18"}),(0,a.jsx)("span",{children:"删除"})]}),(0,a.jsx)(i.E.div,{className:"card"===ep?"glass card":"table-row",drag:"list"===ep&&!!e5&&"x",dragConstraints:{left:-80,right:0},dragElastic:.1,dragDirectionLock:!0,onDragStart:(e,t)=>{},animate:"list"===ep&&e5?{x:e8===e.code?-80:0}:void 0,onDragEnd:(t,s)=>{let{offset:a,velocity:n}=s;"list"===ep&&e5&&(a.x<-40?e6(e.code):e6(null))},onClick:t=>{"list"===ep&&e5&&e8===e.code&&(t.stopPropagation(),e6(null))},style:{background:"list"===ep?"var(--bg)":void 0,position:"relative",zIndex:1},children:"list"===ep?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"table-cell name-cell",children:["all"!==ee&&"fav"!==ee?(0,a.jsx)("button",{className:"icon-button fav-button",onClick:t=>{t.stopPropagation(),ty(e.code)},title:"从当前分组移除",children:(0,a.jsx)(b,{width:"18",height:"18",style:{transform:"rotate(180deg)"}})}):(0,a.jsx)("button",{className:"icon-button fav-button ".concat(X.has(e.code)?"active":""),onClick:t=>{t.stopPropagation(),tx(e.code)},title:X.has(e.code)?"取消自选":"添加自选",children:(0,a.jsx)(S,{width:"18",height:"18",filled:X.has(e.code)})}),(0,a.jsxs)("div",{className:"title-text",children:[(0,a.jsx)("span",{className:"name-text ".concat(e.jzrq===e2?"updated":""),title:e.jzrq===e2?"今日净值已更新":"",children:e.name}),(0,a.jsxs)("span",{className:"muted code-text",children:["#",e.code]})]})]}),(()=>{var t,s,n;let l=new Date().getHours()>=9,i=e.jzrq===e2;return eX&&l&&!i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-cell text-right value-cell",children:(0,a.jsx)("span",{style:{fontWeight:700},children:e.estPricedCoverage>.05?e.estGsz.toFixed(4):null!==(s=e.gsz)&&void 0!==s?s:"—"})}),(0,a.jsx)("div",{className:"table-cell text-right change-cell",children:(0,a.jsx)("span",{className:e.estPricedCoverage>.05?e.estGszzl>0?"up":e.estGszzl<0?"down":"":Number(e.gszzl)>0?"up":0>Number(e.gszzl)?"down":"",style:{fontWeight:700},children:e.estPricedCoverage>.05?"".concat(e.estGszzl>0?"+":"").concat(e.estGszzl.toFixed(2),"%"):"number"==typeof e.gszzl?"".concat(e.gszzl>0?"+":"").concat(e.gszzl.toFixed(2),"%"):null!==(n=e.gszzl)&&void 0!==n?n:"—"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"table-cell text-right value-cell",children:(0,a.jsx)("span",{style:{fontWeight:700},children:null!==(t=e.dwjz)&&void 0!==t?t:"—"})}),(0,a.jsx)("div",{className:"table-cell text-right change-cell",children:(0,a.jsx)("span",{className:e.zzl>0?"up":e.zzl<0?"down":"",style:{fontWeight:700},children:void 0!==e.zzl?"".concat(e.zzl>0?"+":"").concat(Number(e.zzl).toFixed(2),"%"):""})})]})})(),(0,a.jsx)("div",{className:"table-cell text-right time-cell",children:(0,a.jsx)("span",{className:"muted",style:{fontSize:"12px"},children:e.gztime||e.time||"-"})}),!e5&&(()=>{let t=eY[e.code],s=e7(e,t),n=s?s.amount:null;return null===n?(0,a.jsx)("div",{className:"table-cell text-right holding-amount-cell",title:"设置持仓",onClick:t=>{t.stopPropagation(),eA({open:!0,fund:e})},children:(0,a.jsxs)("span",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:"12px",cursor:"pointer"},children:["未设置 ",(0,a.jsx)(x,{width:"12",height:"12"})]})}):(0,a.jsxs)("div",{className:"table-cell text-right holding-amount-cell",title:"点击设置持仓",onClick:t=>{t.stopPropagation(),eP({open:!0,fund:e})},children:[(0,a.jsxs)("span",{style:{fontWeight:700,marginRight:6},children:["\xa5",n.toFixed(2)]}),(0,a.jsx)("button",{className:"icon-button",onClick:t=>{t.stopPropagation(),eP({open:!0,fund:e})},title:"编辑持仓",style:{border:"none",width:"28px",height:"28px",marginLeft:-6},children:(0,a.jsx)(x,{width:"14",height:"14"})})]})})(),(()=>{let t=eY[e.code],s=e7(e,t),n=s?s.profitToday:null,l=null!==n;return(0,a.jsx)("div",{className:"table-cell text-right profit-cell",children:(0,a.jsx)("span",{className:l?n>0?"up":n<0?"down":"":"muted",style:{fontWeight:700},children:l?"".concat(n>0?"+":n<0?"-":"","\xa5").concat(Math.abs(n).toFixed(2)):""})})})(),!e5&&(()=>{let t=eY[e.code],s=e7(e,t),n=s?s.profitTotal:null,l=t&&t.cost&&t.share?t.cost*t.share:0,i=eU[e.code],r=null!==n,o=r?i&&l>0?"".concat(n>0?"+":n<0?"-":"").concat(Math.abs(n/l*100).toFixed(2),"%"):"".concat(n>0?"+":n<0?"-":"","\xa5").concat(Math.abs(n).toFixed(2)):"";return(0,a.jsx)("div",{className:"table-cell text-right holding-cell",title:"点击切换金额/百分比",onClick:t=>{t.stopPropagation(),r&&eV(t=>({...t,[e.code]:!t[e.code]}))},style:{cursor:r?"pointer":"default"},children:(0,a.jsx)("span",{className:r?n>0?"up":n<0?"down":"":"muted",style:{fontWeight:700},children:o})})})(),(0,a.jsx)("div",{className:"table-cell text-center action-cell",style:{gap:4},children:(0,a.jsx)("button",{className:"icon-button danger",onClick:()=>!Y&&tS(e),title:"删除",disabled:Y,style:{width:"28px",height:"28px",opacity:Y?.6:1,cursor:Y?"not-allowed":"pointer"},children:(0,a.jsx)(p,{width:"14",height:"14"})})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"row",style:{marginBottom:10},children:[(0,a.jsxs)("div",{className:"title",children:["all"!==ee&&"fav"!==ee?(0,a.jsx)("button",{className:"icon-button fav-button",onClick:t=>{t.stopPropagation(),ty(e.code)},title:"从当前分组移除",children:(0,a.jsx)(b,{width:"18",height:"18",style:{transform:"rotate(180deg)"}})}):(0,a.jsx)("button",{className:"icon-button fav-button ".concat(X.has(e.code)?"active":""),onClick:t=>{t.stopPropagation(),tx(e.code)},title:X.has(e.code)?"取消自选":"添加自选",children:(0,a.jsx)(S,{width:"18",height:"18",filled:X.has(e.code)})}),(0,a.jsxs)("div",{className:"title-text",children:[(0,a.jsx)("span",{className:"name-text ".concat(e.jzrq===e2?"updated":""),title:e.jzrq===e2?"今日净值已更新":"",children:e.name}),(0,a.jsxs)("span",{className:"muted",children:["#",e.code]})]})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsxs)("div",{className:"badge-v",children:[(0,a.jsx)("span",{children:"估值时间"}),(0,a.jsx)("strong",{children:e.gztime||e.time||"-"})]}),(0,a.jsx)("div",{className:"row",style:{gap:4},children:(0,a.jsx)("button",{className:"icon-button danger",onClick:()=>!Y&&tS(e),title:"删除",disabled:Y,style:{width:"28px",height:"28px",opacity:Y?.6:1,cursor:Y?"not-allowed":"pointer"},children:(0,a.jsx)(p,{width:"14",height:"14"})})})]})]}),(0,a.jsxs)("div",{className:"row",style:{marginBottom:12},children:[(0,a.jsx)(I,{label:"单位净值",value:null!==(t=e.dwjz)&&void 0!==t?t:"—"}),(()=>{let t=new Date().getHours()>=9,s=e.jzrq===e2;return eX&&t&&!s?null:(0,a.jsx)(I,{label:"涨跌幅",value:void 0!==e.zzl?"".concat(e.zzl>0?"+":"").concat(Number(e.zzl).toFixed(2),"%"):"",delta:e.zzl})})(),(0,a.jsx)(I,{label:"估值净值",value:e.estPricedCoverage>.05?e.estGsz.toFixed(4):null!==(s=e.gsz)&&void 0!==s?s:"—"}),(0,a.jsx)(I,{label:"估值涨跌幅",value:e.estPricedCoverage>.05?"".concat(e.estGszzl>0?"+":"").concat(e.estGszzl.toFixed(2),"%"):"number"==typeof e.gszzl?"".concat(e.gszzl>0?"+":"").concat(e.gszzl.toFixed(2),"%"):null!==(n=e.gszzl)&&void 0!==n?n:"—",delta:e.estPricedCoverage>.05?e.estGszzl:Number(e.gszzl)||0})]}),(0,a.jsx)("div",{className:"row",style:{marginBottom:12},children:(()=>{let t=eY[e.code],s=e7(e,t);return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"stat",style:{cursor:"pointer",flexDirection:"column",gap:4},onClick:()=>eP({open:!0,fund:e}),children:[(0,a.jsxs)("span",{className:"label",style:{display:"flex",alignItems:"center",gap:4},children:["持仓金额 ",(0,a.jsx)(x,{width:"12",height:"12",style:{opacity:.7}})]}),(0,a.jsxs)("span",{className:"value",children:["\xa5",s.amount.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"stat",style:{flexDirection:"column",gap:4},children:[(0,a.jsx)("span",{className:"label",children:"当日盈亏"}),(0,a.jsxs)("span",{className:"value ".concat(s.profitToday>0?"up":s.profitToday<0?"down":""),children:[s.profitToday>0?"+":s.profitToday<0?"-":"","\xa5",Math.abs(s.profitToday).toFixed(2)]})]}),null!==s.profitTotal&&(0,a.jsxs)("div",{className:"stat",onClick:t=>{t.stopPropagation(),eV(t=>({...t,[e.code]:!t[e.code]}))},style:{cursor:"pointer",flexDirection:"column",gap:4},title:"点击切换金额/百分比",children:[(0,a.jsxs)("span",{className:"label",children:["持有收益",eU[e.code]?"(%)":""]}),(0,a.jsxs)("span",{className:"value ".concat(s.profitTotal>0?"up":s.profitTotal<0?"down":""),children:[s.profitTotal>0?"+":s.profitTotal<0?"-":"",eU[e.code]?"".concat(Math.abs(t.cost*t.share?s.profitTotal/(t.cost*t.share)*100:0).toFixed(2),"%"):"\xa5".concat(Math.abs(s.profitTotal).toFixed(2))]})]})]}):(0,a.jsxs)("div",{className:"stat",style:{flexDirection:"column",gap:4},children:[(0,a.jsx)("span",{className:"label",children:"持仓金额"}),(0,a.jsxs)("div",{className:"value muted",style:{fontSize:"14px",display:"flex",alignItems:"center",gap:4,cursor:"pointer"},onClick:()=>eA({open:!0,fund:e}),children:["未设置 ",(0,a.jsx)(x,{width:"12",height:"12"})]})]})})()}),e.estPricedCoverage>.05&&(0,a.jsxs)("div",{style:{fontSize:"10px",color:"var(--muted)",marginTop:-8,marginBottom:10,textAlign:"right"},children:["基于 ",Math.round(100*e.estPricedCoverage),"% 持仓估算"]}),(0,a.jsx)("div",{style:{marginBottom:8,cursor:"pointer",userSelect:"none"},className:"title",onClick:()=>tg(e.code),children:(0,a.jsxs)("div",{className:"row",style:{width:"100%",flex:1},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)("span",{children:"前10重仓股票"}),(0,a.jsx)(y,{width:"16",height:"16",className:"muted",style:{transform:U.has(e.code)?"rotate(0deg)":"rotate(-90deg)",transition:"transform 0.2s ease"}})]}),(0,a.jsx)("span",{className:"muted",children:"涨跌幅 / 占比"})]})}),(0,a.jsx)(l.M,{children:U.has(e.code)&&(0,a.jsx)(i.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{overflow:"hidden"},children:Array.isArray(e.holdings)&&e.holdings.length?(0,a.jsx)("div",{className:"list",children:e.holdings.map((e,t)=>(0,a.jsxs)("div",{className:"item",children:[(0,a.jsx)("span",{className:"name",children:e.name}),(0,a.jsxs)("div",{className:"values",children:["number"==typeof e.change&&(0,a.jsxs)("span",{className:"badge ".concat(e.change>0?"up":e.change<0?"down":""),style:{marginRight:8},children:[e.change>0?"+":"",e.change.toFixed(2),"%"]}),(0,a.jsx)("span",{className:"weight",children:e.weight})]})]},t))}):(0,a.jsx)("div",{className:"muted",style:{padding:"8px 0"},children:"暂无重仓数据"})})})]})})]},e.code)})})]})},ep)})]})]})]}),(0,a.jsx)(l.M,{children:eQ&&(0,a.jsx)(A,{title:"删除确认",message:'基金 "'.concat(eQ.name,'" 存在持仓记录。删除后将移除该基金及其持仓数据，是否继续？'),confirmText:"确定删除",onConfirm:()=>{tC(eQ.code),e0(null)},onCancel:()=>e0(null)})}),(0,a.jsxs)("div",{className:"footer",children:[(0,a.jsx)("p",{style:{marginBottom:8},children:"数据源：实时估值与重仓直连东方财富，仅供个人学习及参考使用。数据可能存在延迟，不作为任何投资建议"}),(0,a.jsx)("p",{style:{marginBottom:12},children:"注：估算数据与真实结算数据会有1%左右误差，非股票型基金误差较大"}),(0,a.jsxs)("div",{style:{marginTop:12,opacity:.8,display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[(0,a.jsxs)("p",{style:{margin:0},children:["遇到任何问题或需求建议可",(0,a.jsx)("button",{className:"link-button",onClick:()=>{ef(e=>e+1),ey(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:"0 4px",textDecoration:"underline",fontSize:"inherit",fontWeight:600},children:"点此提交反馈"})]}),(0,a.jsxs)("button",{onClick:()=>eG(!0),style:{background:"transparent",border:"none",color:"var(--muted)",fontSize:"12px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:4,padding:"4px 8px",borderRadius:"6px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.color="var(--primary)",e.currentTarget.style.background="rgba(255, 255, 255, 0.05)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--muted)",e.currentTarget.style.background="transparent"},children:[(0,a.jsx)("span",{children:"☕"}),(0,a.jsx)("span",{children:"点此请作者喝杯咖啡"})]})]})]}),(0,a.jsx)(l.M,{children:eg&&(0,a.jsx)(B,{onClose:()=>ey(!1)},ej)}),(0,a.jsx)(l.M,{children:eD&&(0,a.jsx)(F,{failures:eL,onClose:()=>eW(!1)})}),(0,a.jsx)(l.M,{children:ei&&(0,a.jsx)(P,{allFunds:r,currentGroupCodes:(null===(e=Z.find(e=>e.id===ee))||void 0===e?void 0:e.codes)||[],onClose:()=>er(!1),onAdd:e=>{if(!e||0===e.length)return;let t=Z.map(t=>t.id===ee?{...t,codes:Array.from(new Set([...t.codes,...e]))}:t);Q(t),localStorage.setItem("groups",JSON.stringify(t)),er(!1),tp({open:!0,message:"成功添加 ".concat(e.length," 支基金")})}})}),(0,a.jsx)(l.M,{children:eO.open&&(0,a.jsx)(D,{fund:eO.fund,onClose:()=>eP({open:!1,fund:null}),onAction:e=>tc(e,eO.fund)})}),(0,a.jsx)(l.M,{children:eR.open&&(0,a.jsx)(W,{type:eR.type,fund:eR.fund,onClose:()=>eJ({open:!1,fund:null,type:"buy"}),onConfirm:e=>td(eR.fund,e)})}),(0,a.jsx)(l.M,{children:e_&&(0,a.jsx)(A,{title:"清空持仓",message:"确定要清空“".concat(null===(t=e_.fund)||void 0===t?void 0:t.name,"”的所有持仓记录吗？此操作不可恢复。"),onConfirm:()=>{(null==e_?void 0:e_.fund)&&to(e_.fund.code,{share:null,cost:null}),eH(null)},onCancel:()=>eH(null),confirmText:"确认清空"})}),(0,a.jsx)(l.M,{children:eT.open&&(0,a.jsx)(L,{fund:eT.fund,holding:eY[null===(s=eT.fund)||void 0===s?void 0:s.code],onClose:()=>eA({open:!1,fund:null}),onSave:e=>{var t;return to(null===(t=eT.fund)||void 0===t?void 0:t.code,e)}})}),(0,a.jsx)(l.M,{children:eq&&(0,a.jsx)("div",{className:"modal-overlay",onClick:()=>eG(!1),children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"glass card modal",style:{maxWidth:"360px"},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:20,justifyContent:"space-between"},children:[(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",gap:10},children:(0,a.jsx)("span",{children:"☕ 请作者喝杯咖啡"})}),(0,a.jsx)("button",{className:"icon-button",onClick:()=>eG(!1),style:{border:"none",background:"transparent"},children:(0,a.jsx)(v,{width:"20",height:"20"})})]}),(0,a.jsx)("div",{style:{marginBottom:20},children:(0,a.jsx)(z,{})}),(0,a.jsx)("div",{className:"muted",style:{fontSize:"12px",textAlign:"center",lineHeight:1.5},children:"感谢您的支持！您的鼓励是我持续维护和更新的动力。"})]})})}),(0,a.jsx)(l.M,{children:en&&(0,a.jsx)(O,{groups:Z,onClose:()=>el(!1),onSave:e=>{Q(e),localStorage.setItem("groups",JSON.stringify(e)),"all"===ee||"fav"===ee||e.find(e=>e.id===ee)||et("all")}})}),(0,a.jsx)(l.M,{children:es&&(0,a.jsx)(R,{onClose:()=>ea(!1),onConfirm:e=>{let t={id:"group_".concat(Date.now()),name:e,codes:[]},s=[...Z,t];Q(s),localStorage.setItem("groups",JSON.stringify(s)),et(t.id),ea(!1)}})}),(0,a.jsx)(l.M,{children:th.open&&(0,a.jsx)(T,{message:th.message,onClose:()=>tp({open:!1,message:""})})}),J&&(0,a.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"设置",onClick:()=>H(!1),children:(0,a.jsxs)("div",{className:"glass card modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(x,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"设置"}),(0,a.jsx)("span",{className:"muted",children:"配置刷新频率"})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"muted",style:{marginBottom:8,fontSize:"0.8rem"},children:"刷新频率"}),(0,a.jsx)("div",{className:"chips",style:{marginBottom:12},children:[10,30,60,120,300].map(e=>(0,a.jsxs)("button",{type:"button",className:"chip ".concat(q===e?"active":""),onClick:()=>G(e),"aria-pressed":q===e,children:[e," 秒"]},e))}),(0,a.jsx)("input",{className:"input",type:"number",min:"10",step:"5",value:q,onChange:e=>G(Number(e.target.value)),placeholder:"自定义秒数"}),q<10&&(0,a.jsx)("div",{className:"error-text",style:{marginTop:8},children:"最小 10 秒"})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"muted",style:{marginBottom:8,fontSize:"0.8rem"},children:"数据导出"}),(0,a.jsx)("div",{className:"row",style:{gap:8},children:(0,a.jsx)("button",{type:"button",className:"button",onClick:tB,children:"导出配置"})}),(0,a.jsx)("div",{className:"muted",style:{marginBottom:8,fontSize:"0.8rem",marginTop:26},children:"数据导入"}),(0,a.jsx)("div",{className:"row",style:{gap:8,marginTop:8},children:(0,a.jsx)("button",{type:"button",className:"button",onClick:()=>{var e,t;return null===(t=tE.current)||void 0===t?void 0:null===(e=t.click)||void 0===e?void 0:e.call(t)},children:"导入配置"})}),(0,a.jsx)("input",{ref:tE,type:"file",accept:"application/json",style:{display:"none"},onChange:tD}),tM&&(0,a.jsx)("div",{className:"muted",style:{marginTop:8},children:tM})]}),(0,a.jsx)("div",{className:"row",style:{justifyContent:"flex-end",marginTop:24},children:(0,a.jsx)("button",{className:"button",onClick:e=>{var t;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e);let s=1e3*Math.max(10,Number(q));M(s),localStorage.setItem("refreshMs",String(s)),H(!1)},disabled:q<10,children:"保存并关闭"})})]})})]})}}},function(e){e.O(0,[340,971,23,744],function(){return e(e.s=783)}),_N_E=e.O()}]);